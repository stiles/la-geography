# LA Geography Layer Configuration
# Official sources for Los Angeles administrative and physical boundaries
# Last updated: 2025-10-19

# =============================================================================
# LAPD BOUNDARIES
# =============================================================================
lapd_bureaus:
  source: arcgis
  url: https://services5.arcgis.com/7nsPwEMP38bSkCjy/ArcGIS/rest/services/LAPD_Bureaus/FeatureServer/0
  description: LAPD Bureaus (4 bureaus - Central, South, Valley, West)
  expected_count: 4
  geometry_type: polygon
  id_field: bureau
  name_field: name
  source_org: LAPD GIS Mapping

lapd_divisions:
  source: arcgis
  url: https://services5.arcgis.com/7nsPwEMP38bSkCjy/arcgis/rest/services/LAPD_Division/FeatureServer/0
  description: LAPD Divisions (21 divisions)
  expected_count: 21
  geometry_type: polygon
  id_field: prec
  name_field: aprec
  source_org: LAPD GIS Mapping

lapd_reporting_districts:
  source: arcgis
  url: https://services5.arcgis.com/7nsPwEMP38bSkCjy/arcgis/rest/services/LAPD_Reporting_District/FeatureServer/0
  description: LAPD Reporting Districts (~1,191 districts)
  expected_count: 1191
  expected_tolerance: 10  # allow +/- 10 features
  geometry_type: polygon
  id_field: repdist
  name_field: repdist
  source_org: LAPD GIS Mapping

# =============================================================================
# LA CITY BOUNDARIES
# =============================================================================
la_city_boundary:
  source: arcgis
  url: https://maps.lacity.org/lahub/rest/services/Boundaries/MapServer/7
  description: Official City of Los Angeles boundary
  expected_count: 1
  geometry_type: polygon
  id_field: null
  name_field: null
  source_org: LA City Bureau of Engineering

la_neighborhoods_comprehensive:
  source: shapefile
  url: https://github.com/datadesk/boundaries.latimes.com/raw/master/shapefiles/neighborhoods/v6/neighborhoods.shp
  description: >
    Comprehensive LA neighborhoods: all cities, unincorporated areas, and LA City neighborhoods.
    The canonical "Where do you live?" map for LA County. Combines incorporated cities 
    (Inglewood, Pasadena, Malibu), unincorporated areas (Marina del Rey, East LA, Hacienda Heights), 
    and LA City neighborhoods (North Hollywood, Venice, Silver Lake).
  expected_count: 269
  expected_tolerance: 5
  geometry_type: polygon
  id_field: slug
  name_field: name
  source_org: LA Times Data Desk
  filter: county == 'los-angeles'
  notes: |
    Source: LA Times Mapping LA project (boundaries.latimes.com)
    GitHub: https://github.com/datadesk/boundaries.latimes.com (archived)
    269 features covering LA County (after filtering out Orange County features)
    
    Fields:
      - slug: URL-safe identifier (e.g., 'marina-del-rey')
      - name: Display name (e.g., 'Marina del Rey')
      - type: 'city', 'unincorporated-area', or neighborhood designation
      - city: 'Los Angeles' for LA City neighborhoods, empty for others
      - region: Geographic grouping (e.g., 'westside', 'south-la', 'san-fernando-valley')
      - county: 'los-angeles' or 'orange'
    
    Recommended starting point for most use cases.

la_city_neighborhoods:
  source: arcgis
  url: https://services5.arcgis.com/7nsPwEMP38bSkCjy/arcgis/rest/services/LA_Times_Neighborhoods/FeatureServer/0
  description: LA Times Neighborhood Boundaries (officially adopted by LA City) - LA City only
  expected_count: 114
  geometry_type: polygon
  id_field: objectid
  name_field: name
  source_org: LA City / LA Times
  notes: |
    This is a subset of the comprehensive LA Times neighborhoods layer,
    containing only the LA City neighborhoods portion (114 features).
    For the complete county-wide layer including all cities and unincorporated
    areas, see la_neighborhoods_comprehensive.

la_city_neighborhood_councils:
  source: arcgis
  url: https://maps.lacity.org/lahub/rest/services/Boundaries/MapServer/18
  description: Certified Neighborhood Councils (~99 councils)
  expected_count: 99
  expected_tolerance: 5
  geometry_type: polygon
  id_field: null  # TBD
  name_field: null  # TBD
  source_org: LA City Department of Neighborhood Empowerment

la_city_council_districts:
  source: arcgis
  url: https://maps.lacity.org/lahub/rest/services/Boundaries/MapServer/13
  description: LA City Council Districts (15 districts)
  expected_count: 15
  geometry_type: polygon
  id_field: district
  name_field: district_name
  source_org: LA City

la_city_parks:
  source: arcgis
  url: https://services5.arcgis.com/7nsPwEMP38bSkCjy/arcgis/rest/services/LARAP_Parks_040220/FeatureServer/0
  description: LA City parks and recreation facilities (561 parks)
  expected_count: 561
  expected_tolerance: 50
  geometry_type: polygon
  id_field: park_id
  name_field: name
  source_org: LA City Department of Recreation and Parks
  notes: |
    Park classes: N (Neighborhood), C (Community), R (Regional)
    Includes small pocket parks (<0.01 sq mi) to large regional parks (6+ sq mi)

# =============================================================================
# LA COUNTY BOUNDARIES
# =============================================================================
la_county_boundary:
  source: arcgis
  url: https://maps.lacity.org/lahub/rest/services/Boundaries/MapServer/15
  description: LA County boundary (mainland + Catalina + San Clemente Island)
  expected_count: 7  # 7 fragments that dissolve into 1 county boundary
  expected_tolerance: 2
  geometry_type: polygon
  id_field: null
  name_field: city_name
  source_org: LA City GeoHub
  notes: |
    Raw layer contains 7 unincorporated area fragments that together form the complete
    LA County boundary (mainland plus Catalina and San Clemente Islands).
    Processing: Dissolve all fragments into single county boundary feature.
    Much cleaner than the previous 11-county source that required filtering.

la_county_cities:
  source: arcgis
  url: https://public.gis.lacounty.gov/public/rest/services/LACounty_Dynamic/Political_Boundaries/MapServer/19
  description: LA County cities and unincorporated areas
  expected_count: 88  # After processing: ~88 cities + unincorporated communities
  expected_tolerance: 10
  geometry_type: polygon
  id_field: null
  name_field: city_name
  source_org: LA County Department of Regional Planning
  notes: |
    Raw layer has 347 features (fragmented cities + water features like piers/breakwaters)
    Processing: Filter feat_type == 'Land', then dissolve by city_name
    Field city_type distinguishes 'City' vs 'Unincorporated'
    Many unincorporated areas dissolve into single "Unincorporated" feature

# NOTE: Commented out - LA County MapServer returns HTML "Loading" page when accessed programmatically
# Works in browser but requires session/authentication for programmatic access
# la_county_supervisor_districts:
#   source: arcgis
#   url: https://arcgis.gis.lacounty.gov/arcgis/rest/services/LACounty_Dynamic/Political_Boundaries/MapServer/27
#   description: LA County Board of Supervisors districts (5 districts, current)
#   expected_count: 5
#   geometry_type: polygon
#   id_field: district
#   name_field: label
#   source_org: LA County Registrar-Recorder/County Clerk
#   notes: |
#     Current supervisorial district boundaries
#     Five supervisorial districts representing LA County
#     Layer ID 27 on arcgis.gis.lacounty.gov (not public.gis subdomain)
#     Alternative endpoints tried:
#     - MapServer/26 on public.gis.lacounty.gov (failed)
#     - MapServer/27 on arcgis.gis.lacounty.gov (browser-only)

# NOTE: Commented out - LA County dynamic MapServer returning HTML instead of JSON
# la_county_zip_codes:
#   source: arcgis
#   url: https://public.gis.lacounty.gov/public/rest/services/LACounty_Dynamic/Administrative_Boundaries/MapServer/5
#   description: ZIP Code boundaries in LA County
#   expected_count: null  # TBD - will determine after first fetch
#   expected_tolerance: 50
#   geometry_type: polygon
#   id_field: zipcode
#   name_field: zipcode
#   source_org: LA County
#   notes: |
#     ZIP Code Tabulation Areas (ZCTAs) for LA County
#     Useful for demographic and spatial analysis

# =============================================================================
# SCHOOLS
# =============================================================================
la_county_school_districts:
  source: arcgis
  url: https://services.arcgis.com/RmCCgQtiZLDCtblq/arcgis/rest/services/School_District/FeatureServer/0
  description: School district boundaries in LA County (85 districts)
  expected_count: 85
  expected_tolerance: 5
  geometry_type: polygon
  id_field: abbr
  name_field: label
  source_org: LA County Office of Education
  notes: |
    Includes Elementary, High School, and Unified school districts
    Some districts extend beyond LA County borders

# =============================================================================
# FREEWAYS / HIGHWAYS
# =============================================================================
la_freeways:
  source: arcgis
  url: https://caltrans-gis.dot.ca.gov/arcgis/rest/services/chhighway/national_highway_system/FeatureServer/0
  description: Interstates and State Highways in LA County
  expected_count: null  # Will vary after clipping and filtering
  geometry_type: line
  id_field: objectid
  name_field: routeid
  source_org: Caltrans
  clip_to: la_county_boundary
  filter: nhs_type == 'INTERSTATE' OR routeid contains 'SHS'
  notes: |
    Processing steps:
    1. Clip statewide layer to LA County boundary
    2. Filter to Interstates (nhs_type == 'INTERSTATE')
    3. Filter to State Highways (routeid contains 'SHS')
    Raw NHS_TYPE categories: INTERSTATE, O-NHS, NISR, MSC, IC, ISC, M21PA
    After filtering: Primarily INTERSTATE and O-NHS (State Highway System routes)

# =============================================================================
# TRANSIT
# =============================================================================
la_metro_lines:
  source: arcgis
  url: https://services.arcgis.com/RmCCgQtiZLDCtblq/arcgis/rest/services/MTA_Metro_Lines/FeatureServer/0
  description: LA Metro rail and bus rapid transit lines
  expected_count: 17
  expected_tolerance: 5
  geometry_type: line
  id_field: objectid
  name_field: label
  source_org: LA Metro (MTA)
  notes: |
    Includes Metro rail lines (A, B, C, D, E, K) and bus rapid transit (G, J)
    STATUS field indicates 'Existing' or 'Construction'
    TYPE field distinguishes 'Rail' vs 'Bus'

# =============================================================================
# PUBLIC SAFETY - FIRE
# =============================================================================
lacofd_station_boundaries:
  source: arcgis
  url: https://services.arcgis.com/RmCCgQtiZLDCtblq/arcgis/rest/services/LACoFD_Fire_Station_Boundaries/FeatureServer/0
  description: LA County Fire Department station boundaries (175 stations)
  expected_count: 175
  expected_tolerance: 10
  geometry_type: polygon
  id_field: stanum
  name_field: stanum
  source_org: LA County Fire Department
  notes: |
    175 full-time fire station service areas (excludes seasonal LA County Fair station)
    Includes battalion (BATTID), division (DIV), and region fields
    Last updated: April 2021

lacofd_station_locations:
  source: arcgis
  url: https://services.arcgis.com/RmCCgQtiZLDCtblq/arcgis/rest/services/LACoFD_Fire_Station_Locations/FeatureServer/0
  description: LA County Fire Department station locations (176 stations)
  expected_count: 176
  expected_tolerance: 5
  geometry_type: point
  id_field: stanum
  name_field: stanum
  source_org: LA County Fire Department
  notes: |
    176 fire station point locations (175 regular + 1 seasonal at LA County Fair)
    Includes addresses, battalion, division, and region
    Data as of October 2020

lafd_station_boundaries:
  source: arcgis
  url: https://services.arcgis.com/xsiPoFK0f7RrxF0D/ArcGIS/rest/services/Find_Station_Final/FeatureServer/1
  description: LA Fire Department station boundaries (102 stations, city only)
  expected_count: 102
  expected_tolerance: 10
  geometry_type: polygon
  id_field: precinctid
  name_field: name
  source_org: LA Fire Department
  notes: |
    LAFD station service areas (City of LA, distinct from LA County Fire)
    Filtered to valid fire stations only (excludes erroneous county polygons)
    Area range: 1.28 - 14.99 sq mi per station
    Data as of April 2021

# NOTE: Commented out - need correct REST endpoint from OpenData portal
# lafd_districts:
#   source: arcgis
#   url: https://services5.arcgis.com/7nsPwEMP38bSkCjy/arcgis/rest/services/LAFD_Battalions/FeatureServer/3
#   description: LA Fire Department district boundaries
#   expected_count: null  # TBD - will determine after first fetch
#   expected_tolerance: 20
#   geometry_type: polygon
#   id_field: objectid
#   name_field: district
#   source_org: LA Fire Department
#   notes: |
#     LAFD operational districts with district, battalion, and division IDs
#     Different from LA County Fire Department
#     OpenData URL: https://data-lahub.opendata.arcgis.com/datasets/691409b93f8d4d9e81f9a593c53ed069_3

# =============================================================================
# PUBLIC SAFETY - POLICE
# =============================================================================
lapd_station_locations:
  source: arcgis
  url: https://services5.arcgis.com/7nsPwEMP38bSkCjy/arcgis/rest/services/LAPD_Police_Stations/FeatureServer/0
  description: LAPD police station locations (21 stations)
  expected_count: 21
  expected_tolerance: 3
  geometry_type: point
  id_field: prec
  name_field: division
  source_org: LAPD
  notes: |
    Point locations of 21 LAPD division stations
    Includes division name, location address, and precinct number
    Complements the existing LAPD division boundaries layer

# =============================================================================
# AIRPORTS
# =============================================================================
la_county_airports:
  source: arcgis
  url: https://arcgis.gis.lacounty.gov/arcgis/rest/services/DRP/A_NET/MapServer/0
  description: LA County airports (commercial and general aviation)
  expected_count: 16
  expected_tolerance: 3
  geometry_type: point
  id_field: objectid
  name_field: name
  source_org: LA County Department of Regional Planning
  notes: |
    Airport locations in LA County (16 total)
    - 4 commercial airports (LAX, Bob Hope/Burbank, Long Beach, Ontario)
    - 11 general aviation airports
    - 1 other (Catalina Airport-In-The-Sky)
    Type field distinguishes 'Commercial Airport' vs 'General Aviation Airport'
    Includes facility names, alternative names, and location data

la_county_airport_noise_contours:
  source: arcgis
  url: https://arcgis.gis.lacounty.gov/arcgis/rest/services/DRP/A_NET/MapServer/6
  description: Airport noise contours (55-85 dB CNEL)
  expected_count: 35
  expected_tolerance: 10
  geometry_type: polygon
  id_field: objectid
  name_field: airport_name
  source_org: LA County Department of Regional Planning
  notes: |
    Community Noise Equivalent Level (CNEL) contours around major airports (35 contours)
    CLASS field indicates noise level: 55, 60, 65, 70, 75, 80, 85 dB
    Used for land use planning and development review near airports
    Includes AIRPORT_NAME (LAX, Burbank, Palmdale, etc.), DATE_RECEIVED, and SOURCE
    Higher dB levels indicate greater noise impact
    Range: 0.00 - 30.70 sq mi per contour

# =============================================================================
# ELECTIONS
# =============================================================================
la_county_election_precincts:
  source: arcgis
  url: https://services.arcgis.com/RmCCgQtiZLDCtblq/arcgis/rest/services/Registrar_Recorder_Precincts_Election/FeatureServer/0
  description: LA County Registrar-Recorder election precincts (current as of Sept 2025)
  expected_count: 1502
  expected_tolerance: 50
  geometry_type: polygon
  id_field: precinct
  name_field: precinct
  source_org: LA County Registrar-Recorder/County Clerk
  notes: |
    Consolidated election precincts established by LA County RR/CC (1502 precincts)
    Updated for current election - last updated September 23, 2025
    Includes voter statistics:
      - VBMVoters: Vote By Mail registered voters
      - PollVoters: Poll voter count
      - BallotGroup: Ballot group identifier
      - SerialNumber: Precinct serial number
    Precincts are consolidated for election administration purposes
    Range: 0.00 - 220.73 sq mi per precinct

# NOTE: Commented out - LA County dynamic MapServer service returning HTML instead of JSON
# Requires authentication - not publicly accessible
# la_county_public_safety_jurisdictions:
#   source: arcgis
#   url: https://public.gis.lacounty.gov/public/rest/services/LACounty_Dynamic/Administrative_Boundaries/MapServer/9
#   description: Public safety jurisdictions (Sheriff, LAPD, city police)
#   expected_count: null
#   geometry_type: polygon

# =============================================================================
# CENSUS DATA
# =============================================================================
census:
  vintage: 2020
  state_fips: "06"  # California
  county_fips: "037"  # Los Angeles County
  geography_level: block
  
  # 2020 Decennial Census Tables (PL 94-171 redistricting file)
  tables:
    P1:
      description: Race
      variables:
        P1_001N: Total population
    
    P2:
      description: Hispanic or Latino, and Not Hispanic or Latino by Race
      variables:
        P2_001N: Total population
        P2_002N: Hispanic or Latino
        P2_003N: Not Hispanic or Latino
        P2_005N: White alone (not Hispanic or Latino)
        P2_006N: Black or African American alone (not Hispanic or Latino)
        P2_007N: American Indian and Alaska Native alone (not Hispanic or Latino)
        P2_008N: Asian alone (not Hispanic or Latino)
        P2_009N: Native Hawaiian and Other Pacific Islander alone (not Hispanic or Latino)
        P2_010N: Some Other Race alone (not Hispanic or Latino)
        P2_011N: Two or More Races (not Hispanic or Latino)
    
    H1:
      description: Occupancy Status
      variables:
        H1_001N: Total housing units
        H1_002N: Occupied
        H1_003N: Vacant
  
  # Simplified column names for output
  column_mapping:
    P1_001N: pop_total
    P2_002N: pop_hispanic
    P2_003N: pop_not_hispanic
    P2_005N: pop_white_nh
    P2_006N: pop_black_nh
    P2_007N: pop_aian_nh
    P2_008N: pop_asian_nh
    P2_009N: pop_nhpi_nh
    P2_010N: pop_other_nh
    P2_011N: pop_two_or_more_nh
    H1_001N: housing_total
    H1_002N: housing_occupied
    H1_003N: housing_vacant

